import pygad


def himmelblaus_function(input_vector) -> float:
    """
    a classic function used to test the performance of local search algorithms
    :param input_vector: vector of [x, y] values
    :return: function value at (x, y)
    """
    x, y = input_vector
    return (x**2 + y - 11)**2 + (x + y**2 - 7)**2


def my_fitness_function(ga_instance, solution, solution_index):
    return -himmelblaus_function(solution)


ga = pygad.pygad.GA(num_generations=1000,
                    num_parents_mating=10,
                    fitness_func=my_fitness_function,
                    sol_per_pop=100,
                    num_genes=2, # each of our solutions is an x-y pair
                    init_range_low=-5,
                    init_range_high=5,
                    parent_selection_type='rws',
                    keep_parents=1,
                    crossover_type='single_point',
                    mutation_type='random',
                    mutation_percent_genes=0.1)

ga.run()
solution, solution_fitness, solution_idx = ga.best_solution()

print(solution)
print(solution_fitness)